{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://multi-agent-orchestrator.dev/schemas/icnp/intent.schema.json",
  "title": "ICNP Intent Schema",
  "description": "Schema for Intent-and-Capability Negotiation Protocol intent declarations",
  "type": "object",
  "required": [
    "icnp_version",
    "phase",
    "message_id",
    "timestamp",
    "intent",
    "sender"
  ],
  "properties": {
    "icnp_version": {
      "type": "string",
      "pattern": "^[0-9]+\\.[0-9]+$",
      "description": "ICNP protocol version"
    },
    "phase": {
      "type": "string",
      "const": "intent_declaration"
    },
    "message_id": {
      "type": "string",
      "format": "uuid"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time"
    },
    "intent": {
      "$ref": "#/definitions/Intent"
    },
    "sender": {
      "$ref": "#/definitions/Sender"
    }
  },
  "definitions": {
    "Intent": {
      "type": "object",
      "required": [
        "action",
        "goals",
        "risk_tolerance",
        "human_approval_required"
      ],
      "properties": {
        "action": {
          "type": "string",
          "description": "What the initiator wants to accomplish"
        },
        "goals": {
          "type": "array",
          "items": { "$ref": "#/definitions/Goal" },
          "minItems": 1
        },
        "non_goals": {
          "type": "array",
          "items": { "$ref": "#/definitions/NonGoal" }
        },
        "constraints": {
          "$ref": "#/definitions/Constraints"
        },
        "risk_tolerance": {
          "type": "string",
          "enum": ["none", "low", "medium", "high"]
        },
        "human_approval_required": {
          "type": "boolean"
        },
        "context": {
          "$ref": "#/definitions/IntentContext"
        }
      }
    },
    "Goal": {
      "type": "object",
      "required": ["id", "priority"],
      "properties": {
        "id": { "type": "string" },
        "description": { "type": "string" },
        "priority": {
          "type": "string",
          "enum": ["critical", "high", "medium", "low"]
        },
        "metric": { "type": "string" },
        "standard": { "type": "string" }
      }
    },
    "NonGoal": {
      "type": "object",
      "required": ["id", "reason"],
      "properties": {
        "id": { "type": "string" },
        "description": { "type": "string" },
        "reason": { "type": "string" },
        "severity": {
          "type": "string",
          "enum": ["hard", "soft"],
          "default": "hard"
        }
      }
    },
    "Constraints": {
      "type": "object",
      "properties": {
        "cost": {
          "type": "object",
          "properties": {
            "max": { "type": "number", "minimum": 0 },
            "currency": { "type": "string" },
            "period": {
              "type": "string",
              "enum": ["hour", "day", "month", "total"]
            }
          }
        },
        "latency": {
          "type": "object",
          "properties": {
            "max_ms": { "type": "number", "minimum": 0 },
            "percentile": { "type": "number", "minimum": 0, "maximum": 100 }
          }
        },
        "data_residency": {
          "type": "array",
          "items": { "type": "string" }
        },
        "time_window": {
          "type": "object",
          "properties": {
            "start": { "type": "string", "pattern": "^[0-2][0-9]:[0-5][0-9]$" },
            "end": { "type": "string", "pattern": "^[0-2][0-9]:[0-5][0-9]$" },
            "timezone": { "type": "string" },
            "days": { "type": "array", "items": { "type": "string" } }
          }
        },
        "resources": {
          "type": "object",
          "properties": {
            "max_cpu_cores": { "type": "number", "minimum": 0 },
            "max_memory_gb": { "type": "number", "minimum": 0 },
            "max_storage_gb": { "type": "number", "minimum": 0 },
            "max_network_mbps": { "type": "number", "minimum": 0 }
          }
        },
        "custom": { "type": "object" }
      }
    },
    "IntentContext": {
      "type": "object",
      "properties": {
        "related_intents": { "type": "array", "items": { "type": "string" } },
        "business_unit": { "type": "string" },
        "project": { "type": "string" },
        "environment": {
          "type": "string",
          "enum": ["development", "staging", "production"]
        },
        "urgency": {
          "type": "string",
          "enum": ["immediate", "soon", "scheduled", "background"]
        }
      }
    },
    "Sender": {
      "type": "object",
      "required": ["id", "type"],
      "properties": {
        "id": { "type": "string" },
        "type": {
          "type": "string",
          "enum": ["autonomous-agent", "human", "service", "system"]
        },
        "trust_level": {
          "type": "string",
          "enum": ["verified", "trusted", "untrusted", "unknown"]
        }
      }
    }
  }
}
